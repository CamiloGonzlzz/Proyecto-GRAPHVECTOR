<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Vector 3D - Líneas Punteadas</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        #grafico {
            width: 100%;
            height: 600px;
        }
        form {
            margin-bottom: 10px;
        }
        label {
            margin-right: 10px;
        }
    </style>
</head>
<body>

    <form id="vectorForm">
        <label>X: <input type="number" id="inputX" required></label>
        <label>Y: <input type="number" id="inputY" required></label>
        <label>Z: <input type="number" id="inputZ" required></label>
        <button type="submit">Graficar</button>
    </form>

    <div id="grafico"></div>

    <script>
        const colorUnico = '#003366';
        const estiloLinea = { color: colorUnico, width: 2, dash: 'dot' };

        function graficarVector(x, y, z) {
            const vectorPrincipal = {
                type: 'scatter3d',
                mode: 'lines',          // línea sólida sin puntos
                x: [0, x], y: [0, y], z: [0, z],
                line: { color: 'red', width: 4 },
                name: 'Vector Principal'
            };

            const proyecciones = [
                { x: [x, x], y: [y, y], z: [0, z] },  // XY plano vertical
                { x: [x], y: [y], z: [0] },           // Punto XY

                { x: [x, x], y: [0, y], z: [z, z] },  // XZ plano horizontal
                { x: [x], y: [0], z: [z] },           // Punto XZ

                { x: [0, x], y: [y, y], z: [z, z] },  // YZ plano lateral
                { x: [0], y: [y], z: [z] },           // Punto YZ
            ].map((p, i) => ({
                type: 'scatter3d',
                mode: i % 2 === 0 ? 'lines' : 'markers',
                x: p.x, y: p.y, z: p.z,
                line: estiloLinea,
                marker: { color: colorUnico, size: 5 },
                name: i % 2 === 0 ? 'Proyección' : 'Punto'
            }));

            const extrapolacionesExtras = [
                [[x, 0], [y, y], [0, 0]],
                [[x, x], [y, 0], [0, 0]],
                [[0, 0], [y, y], [z, 0]],
                [[0, 0], [y, 0], [z, z]],
                [[x, 0], [0, 0], [z, z]],
                [[x, x], [0, 0], [z, 0]]
            ].map(coords => ({
                type: 'scatter3d',
                mode: 'lines',
                x: coords[0], y: coords[1], z: coords[2],
                line: estiloLinea,
                name: 'Línea auxiliar'
            }));

            const componentes = [
                [[0, x], [0, 0], [0, 0]], // X
                [[x, x], [0, y], [0, 0]], // Y
                [[x, x], [y, y], [0, z]]  // Z
            ].map(coords => ({
                type: 'scatter3d',
                mode: 'lines',
                x: coords[0], y: coords[1], z: coords[2],
                line: estiloLinea,
                name: 'Componente'
            }));

            // Calcula límites dinámicos para cada eje
            function calcularLimites(valor) {
                if (valor >= 0) {
                    return [0, valor + 2];
                } else {
                    return [valor - 2, 0];
                }
            }

            const xlim = calcularLimites(x);
            const ylim = calcularLimites(y);
            const zlim = calcularLimites(z);

            function ajustarRango([min, max]) {
                if (Math.abs(max - min) < 4) {
                    const centro = (max + min) / 2;
                    return [centro - 2, centro + 2];
                }
                return [min, max];
            }

            const xRange = ajustarRango(xlim);
            const yRange = ajustarRango(ylim);
            const zRange = ajustarRango(zlim);

            const layout = {
                margin: { l: 0, r: 0, b: 0, t: 0 },
                scene: {
                    xaxis: { title: 'X', range: xRange },
                    yaxis: { title: 'Y', range: yRange },
                    zaxis: { title: 'Z', range: zRange }
                },
                legend: {
                    x: 1.05,
                    y: 1
                }
            };

            Plotly.newPlot('grafico', [
                vectorPrincipal,
                ...proyecciones,
                ...extrapolacionesExtras,
                ...componentes
            ], layout);
        }

        // Evento para manejar el submit del formulario
        document.getElementById('vectorForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const x = parseFloat(document.getElementById('inputX').value);
            const y = parseFloat(document.getElementById('inputY').value);
            const z = parseFloat(document.getElementById('inputZ').value);

            graficarVector(x, y, z);
        });


        // Graficar un vector inicial por defecto
        graficarVector(1, 4, 5);
    </script>
</body>
</html>
